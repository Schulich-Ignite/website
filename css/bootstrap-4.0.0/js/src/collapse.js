import $ from"jquery";import Util from"./util";const Collapse=(t=>{const e="collapse",s="bs.collapse",i=t.fn[e],n={toggle:!0,parent:""},l={toggle:"boolean",parent:"(string|element)"},r="show",a="collapse",o="collapsing",g="collapsed",h="width",c='[data-toggle="collapse"]';class _{constructor(e,s){this._isTransitioning=!1,this._element=e,this._config=this._getConfig(s),this._triggerArray=t.makeArray(t(`[data-toggle="collapse"][href="#${e.id}"],[data-toggle="collapse"][data-target="#${e.id}"]`));const i=t(c);for(let s=0;s<i.length;s++){const n=i[s],l=Util.getSelectorFromElement(n);null!==l&&t(l).filter(e).length>0&&(this._selector=l,this._triggerArray.push(n))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}static get VERSION(){return"4.0.0"}static get Default(){return n}toggle(){t(this._element).hasClass(r)?this.hide():this.show()}show(){if(this._isTransitioning||t(this._element).hasClass(r))return;let e,i;if(this._parent&&(e=t.makeArray(t(this._parent).find(".show, .collapsing").filter(`[data-parent="${this._config.parent}"]`)),0===e.length&&(e=null)),e&&(i=t(e).not(this._selector).data(s),i&&i._isTransitioning))return;const n=t.Event("show.bs.collapse");if(t(this._element).trigger(n),n.isDefaultPrevented())return;e&&(_._jQueryInterface.call(t(e).not(this._selector),"hide"),i||t(e).data(s,null));const l=this._getDimension();t(this._element).removeClass(a).addClass(o),this._element.style[l]=0,this._triggerArray.length>0&&t(this._triggerArray).removeClass(g).attr("aria-expanded",!0),this.setTransitioning(!0);const h=()=>{t(this._element).removeClass(o).addClass(a).addClass(r),this._element.style[l]="",this.setTransitioning(!1),t(this._element).trigger("shown.bs.collapse")};if(!Util.supportsTransitionEnd())return void h();const c="scroll"+(l[0].toUpperCase()+l.slice(1));t(this._element).one(Util.TRANSITION_END,h).emulateTransitionEnd(600),this._element.style[l]=this._element[c]+"px"}hide(){if(this._isTransitioning||!t(this._element).hasClass(r))return;const e=t.Event("hide.bs.collapse");if(t(this._element).trigger(e),e.isDefaultPrevented())return;const s=this._getDimension();if(this._element.style[s]=this._element.getBoundingClientRect()[s]+"px",Util.reflow(this._element),t(this._element).addClass(o).removeClass(a).removeClass(r),this._triggerArray.length>0)for(let e=0;e<this._triggerArray.length;e++){const s=this._triggerArray[e],i=Util.getSelectorFromElement(s);null!==i&&(t(i).hasClass(r)||t(s).addClass(g).attr("aria-expanded",!1))}this.setTransitioning(!0);const i=()=>{this.setTransitioning(!1),t(this._element).removeClass(o).addClass(a).trigger("hidden.bs.collapse")};this._element.style[s]="",Util.supportsTransitionEnd()?t(this._element).one(Util.TRANSITION_END,i).emulateTransitionEnd(600):i()}setTransitioning(t){this._isTransitioning=t}dispose(){t.removeData(this._element,s),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null}_getConfig(t){return(t={...n,...t}).toggle=Boolean(t.toggle),Util.typeCheckConfig(e,t,l),t}_getDimension(){return t(this._element).hasClass(h)?h:"height"}_getParent(){let e=null;Util.isElement(this._config.parent)?(e=this._config.parent,void 0!==this._config.parent.jquery&&(e=this._config.parent[0])):e=t(this._config.parent)[0];const s=`[data-toggle="collapse"][data-parent="${this._config.parent}"]`;return t(e).find(s).each((t,e)=>{this._addAriaAndCollapsedClass(_._getTargetFromElement(e),[e])}),e}_addAriaAndCollapsedClass(e,s){if(e){const i=t(e).hasClass(r);s.length>0&&t(s).toggleClass(g,!i).attr("aria-expanded",i)}}static _getTargetFromElement(e){const s=Util.getSelectorFromElement(e);return s?t(s)[0]:null}static _jQueryInterface(e){return this.each((function(){const i=t(this);let l=i.data(s);const r={...n,...i.data(),..."object"==typeof e&&e};if(!l&&r.toggle&&/show|hide/.test(e)&&(r.toggle=!1),l||(l=new _(this,r),i.data(s,l)),"string"==typeof e){if(void 0===l[e])throw new TypeError(`No method named "${e}"`);l[e]()}}))}}return t(document).on("click.bs.collapse.data-api",c,(function(e){"A"===e.currentTarget.tagName&&e.preventDefault();const i=t(this),n=Util.getSelectorFromElement(this);t(n).each((function(){const e=t(this),n=e.data(s)?"toggle":i.data();_._jQueryInterface.call(e,n)}))})),t.fn[e]=_._jQueryInterface,t.fn[e].Constructor=_,t.fn[e].noConflict=function(){return t.fn[e]=i,_._jQueryInterface},_})($);export default Collapse;