<!doctype html><html style=overflow-x:hidden><head><meta charset=utf-8><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","author":"Schulich Ignite","name":"Writing your own HTTP server","dateCreated":"2023-88-06","text":"HTTP is the way that we communicate over the internet. It\u0026rsquo;s what allows you to see the content you\u0026rsquo;re currently looking at.","image":"\/img\/blog\/hhttpp\/hero.jpg"}</script><title>Writing your own HTTP server | Schulich Ignite</title><link rel="shortcut icon" href=https://schulichignite.com/img/favicon.ico type=image/x-icon><link rel=icon href=https://schulichignite.com/img/favicon.ico type=image/x-icon><meta property="og:title" content=" Writing your own HTTP server | Schulich Ignite Blog "><meta property="og:type" content="website"><meta property="og:url" content=" https://schulichignite.com/blog/hhttpp/series-introduction/ "><meta property="og:image" content="/img/blog/hhttpp/hero.jpg "><meta name=Description content=" Writing your own HTTP server; HTTP is the way that we communicate over the internet. It&rsquo;s what allows you to see the content you&rsquo;re currently looking at. "><meta property="og:description" content=" Writing your own HTTP server; HTTP is the way that we communicate over the internet. It&rsquo;s what allows you to see the content you&rsquo;re currently looking at. "><link href="https://fonts.googleapis.com/css2?family=Raleway:wght@900&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Encode+Sans+Semi+Condensed:wght@900&display=swap" rel=stylesheet><link href=https://unpkg.com/video.js@7/dist/video-js.min.css rel=stylesheet><link href=https://unpkg.com/@videojs/themes@1/dist/sea/index.css rel=stylesheet><link rel=stylesheet href=https://schulichignite.com/css/index.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/vs2015.min.css integrity="sha512-mtXspRdOWHCYp+f4c7CkWGYPPRAhq9X+xCvJMUBVAb6pqA4U8pxhT3RWT3LP3bKbiolYL2CkL1bSKZZO4eeTew==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css></head><nav class="navbar sticky-top navbar-expand-lg navbar-dark bg-dark"><a class=navbar-brand href=../../../><img src=https://schulichignite.com/img/logos/ignite.svg width=40 height=60 alt="Schulich ignite logo">
<span class=brand-name>Schulich Ignite</span></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Sessions</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=../../../beginner>Ignite Beginner</a>
<a class=dropdown-item href=../../../flare>Ignite Flare</a>
<a class=dropdown-item href=../../../scorch>Ignite Scorch</a></div></li></li><li class=nav-item><a class=nav-link href=https://forms.gle/ZJoDAbcTf1M3NBxYA target=_blank rel="noopener noreferrer">Mailing list</a></li><li class=nav-item><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Media</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=../../../blog>Blog</a>
<a class=dropdown-item href=../../../definitions>Definitions</a></div></li></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=../../../mission>Our Mission</a>
<a class=dropdown-item href=../../../team>Our Team</a></li><li class=nav-item><a class=nav-link href=../../../contact>Contact</a></li></ul></div></nav><body><div class=diagonal-header><div class=mainheader>Blog</div><div class="subheader dates d-none d-sm-block"><span class=long-dates>Monday, Aug 28, 2023</span>
<span class=short-dates>08/28/23</span></div></div><section class=section><img class="card-img-top large-image blog-hero-image" src=../../../img/blog/hhttpp/hero.jpg><div class=container><div class=row><div class="card no-background"><div class=card-body><h1 class=card-title>Writing your own HTTP server</h1><h3 style=font-size:1em;color:#787878>HHTTPP creation Series Introduction & Setup</h3><a class="btn btn-secondary my-2" href=../../../blog>&larr; Go back to blog</a><div id=article-info class=card><div class=row><div class=col-md-6><div class=card-body><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#terms--concepts>Terms & Concepts</a><ul><li><a href=#anatomy-of-a-url>Anatomy of a URL</a></li></ul></li><li><a href=#what-is-an-http-proxy>What is an HTTP proxy?</a></li><li><a href=#order-of-development>Order of development</a></li><li><a href=#source-code>Source code</a></li><li><a href=#code-a-long-ness>Code-a-long-ness</a><ul><li><a href=#python-syntax>Python syntax</a></li></ul></li><li><a href=#project-setup>Project setup</a><ul><li><a href=#how-pip-works>How pip works</a></li><li><a href=#customizing-the-template>Customizing the template</a></li></ul></li></ul></nav></p></div></div><div class=col-md-6><div class=card-body><p class=card-text><i class="bi bi-calendar2-week-fill"></i> <time>Monday, Aug 28, 2023</time></p><p class=card-text><i class="bi bi-stopwatch-fill"></i><em>~10 Minute Read</em><br><em><i class="bi bi-tags-fill"></i></em>
<a href=https://schulichignite.com/tags/python/>python</a>,
<a href=https://schulichignite.com/tags/scorch/>scorch</a>,
<a href=https://schulichignite.com/tags/web/>web</a>,
<a href=https://schulichignite.com/tags/theory/>theory</a></p><h4>Author(s) information</h4><div id=author-information><a href=https://schulichignite.com/authors/kieran-wood/ target=_blank rel="noopener noreferrer"><img width=100rem src=../../../img/blog/avatars/kieran.jpg alt></a><h6 class=card-title><a href=https://schulichignite.com/authors/kieran-wood/ target=_blank rel="noopener noreferrer"><br>Kieran Wood</a></h6><div id=author-icons><a href=mailto:kieran@canadiancoding.ca><i class="bi bi-envelope-fill"></i></a>
<a href=https://github.com/descent098 target=_blank><i class="bi bi-github"></i></a>
<a href=https://linkedin.com/in/kieran-wood target=_blank><i class="bi bi-linkedin"></i></a>
<a href=https://kieranwood.ca target=_blank><i class="bi bi-globe"></i></a></div><div class=text-primary style=max-width:40ch><p>I&rsquo;m a computer science major, with a minor in philosophy. I love to do open source work, especially in scripting, automation, web development, API&rsquo;s, CLI&rsquo;s and dev ops!</p></div></div></div></div></div></div></div><hr><div id=article-content class="card-text blog-text"><p>HTTP is the way that we communicate over the internet. It&rsquo;s what allows you to see the content you&rsquo;re currently looking at. The overall goal with the project is to create a simple <a href=#what-is-an-http-proxy>HTTP proxy server</a>. It is <strong>not</strong> designed to be a framework with routing, or any other fancy features.</p><p>On top of that, there are a few caveats:</p><ol><li>It will only support <strong>parts</strong> of the HTTP 1.1 spec (just enough to work for basic use)</li><li>It will only support a portion of the HTTP response codes</li><li>It will not have optimizations like caching or multithreading</li></ol><h2 id=terms--concepts>Terms & Concepts</h2><p>To start there are some terms we need to understand in order to understand HTTP (<a href="https://www.youtube.com/watch?v=SzSXHv8RKdM">this video is also pretty good</a>). Here are some of the basics:</p><table><thead><tr><th>Term</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td>IP Address</td><td>This is what computers use to communicate with one another, it is similar to an actual address</td><td><code>127.0.0.1</code> is the IP address reserved for the computer you&rsquo;re currently on, so if you need to communicate with yourself you can (this is useful for testing)</td></tr><tr><td>Port</td><td>A computer can have multiple servers running on it. Each of these &ldquo;servers&rdquo; runs on a different port so you can communicate with them sparately</td><td>If you are running a server on your own machine and have it on port 8080 you can access it in a browser at <code>http://localhost:8080</code></td></tr><tr><td>Proxy/alias</td><td>In our context we&rsquo;re using this to mean something that stands-in or is replaced by something else</td><td>For <code>localhost</code> is a proxy for <code>127.0.0.1</code> on your computer, so if you go to <code>localhost</code> it is the same as going to <code>127.0.0.1</code></td></tr><tr><td>Host</td><td>The name of a computer (local/on the machine)</td><td>Let&rsquo;s say you gave your PC the name <code>thoth</code> when you set it up, then on your own network you can access it at <code>thoth</code> or <code>thoth.local</code> (an alias for an IP)</td></tr></tbody></table><h3 id=anatomy-of-a-url>Anatomy of a URL</h3><p>Some of the most important terms we need to understand are what makes up a URL. A URL is what we type into a browser bar to get to a site (i.e. <a href=https://schulichignite.com>https://schulichignite.com</a>). Here is a diagram breaking apart the different peices:</p><p><img src=../../../img/blog/hhttpp/Post%201/url-anatomy.png alt></p><p>For those of you that can&rsquo;t read the image, this is the basic anatomy of a URL:</p><pre tabindex=0><code>&lt;protocol&gt;://&lt;domain/hostname/ip&gt;:&lt;port(optional)&gt;&lt;slug/URI&gt;
</code></pre><p>For example here are some URL&rsquo;s:</p><pre tabindex=0><code>http://127.0.0.1:80/
http://localhost:8000/
http://thoth:32400/web/index
http://schulichignite.com/contact
http://example-site.co.uk/about-us
</code></pre><table><thead><tr><th>Term</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td>Protocol</td><td>The protocol is the rules and procedures that the browser should follow to communicate with the underlying server</td><td><code>http://</code>, <code>https://</code>, <code>file://</code></td></tr><tr><td>Domain</td><td>The name of a computer (remote/on a server accessible to the internet)</td><td>When you go to <code>google.ca</code> that is a domain, the domain itself is an alias for the IP address of a server that returns the webpage you&rsquo;re looking for domains have 2 parts, the domain name, and the TLD</td></tr><tr><td>Domain Name</td><td>The domain name is the main portion of the domain, before the <code>.</code></td><td>google, netflix, schulichignite</td></tr><tr><td>TLD (top-level domain)</td><td>These groupings of domains used to serve more of a roll before, but now are mostly all the same. They are the letters that come after a <code>.</code> in a URL, and indicate usually which country the service is from</td><td><code>.ca</code>,<code>.com</code>,<code>.co.uk</code>,<code>.sh</code></td></tr><tr><td>Slug/URI</td><td>The part that comes after a domain to indicate which specific resource you want from the specified server on the specified port</td><td><code>/</code>, <code>/about</code>,<code>/blog/title</code></td></tr></tbody></table><h2 id=what-is-an-http-proxy>What is an HTTP proxy?</h2><p>A proxy server in this context is a server that will allow you to access the files in a given folder (called the proxy folder) over HTTP. So essentially when you access a URL on the proxy it will treat the slug as a path to a file. That was a lot of words, so lets look at an example. Let&rsquo;s say you have a proxy folder:</p><pre tabindex=0><code>ğŸ“proxy_folder/
â”œâ”€â”€ ğŸ“blog/
â”‚   â””â”€â”€ ğŸ“„how-to-make-alfredo.html
â””â”€â”€ ğŸ“„ about.html
</code></pre><p>Then if it&rsquo;s proxied to <code>ignite.com</code> if you go to <code>ignite.com/about</code> it will send you the contents of <code>proxy_folder/about.html</code> over HTTP. Essentially <code>ignite.com</code> becomes an alias for <code>proxy_folder</code> and users are basically typing in glorified file paths to get your content. Same thing if you went to <code>ignite.com/blog/how-to-make-alfredo.html</code> would give you the content of <code>proxy_folder/blog/how-to-make-alfredo.html</code> via HTTP:</p><p><img src=../../../img/blog/hhttpp/proxy-basics.png alt></p><p>The functionality for hhttpp is based of the built in <code>http.server</code> module in python (in functionality, <strong>not approach</strong>). To see what this might look like open up a terminal inside <code>/example_site</code> and then run <code>python -m http.server 8118</code> from there go to your browser and type in <a href=http://localhost:8118>http://localhost:8118</a>. You will be able to access all the pages inside the folder from your browser!</p><p>In our case we will be using <a href=https://github.com/Descent098/HHTTPP/tree/master/example_site>these files</a>, which when hosted correctly look like <a href=https://kieranwood.ca/chat-blog/>this</a>. This is what we&rsquo;re aiming to recreate with <code>hhttpp</code>!</p><h2 id=order-of-development>Order of development</h2><p>In order to get things to work we will first implement the HTTP information <strong>without</strong> real networking, once we have an HTTP implementation that works without networking, we will cover networking. The reason we do things this way is because it seperates the complexity so that we aren&rsquo;t troubleshooting HTTP <strong>AND</strong> networking at the same time. Once we have the &ldquo;language&rdquo; (protocol) we&rsquo;re going to talk in, then we&rsquo;ll focus on how to &ldquo;speak&rdquo; it (send network requests).</p><p>So the series will roughly be in this order for the posts (0 is this post):</p><ol start=0><li>Getting the project setup; Getting the boring python packaging bits out of the way</li><li>Create request and response objects to house our info<ul><li>Status codes</li><li>MIME types</li></ul></li><li>Use request and response objects to generate proper request/response headers and content encoding</li><li>Implementing the networking portion</li><li>Definining a CLI (command line interface); Lets people use our system more easily</li></ol><h2 id=source-code>Source code</h2><p>Each post will be in it&rsquo;s own folder in the <a href=https://github.com/Descent098/HHTTPP>git repository</a>. So for example today would be considered post 0, which can be <a href=https://github.com/Descent098/HHTTPP/tree/master/Post%200>found here</a>. Again the code again is not meant to be <strong>the only</strong> way to achieve this, it&rsquo;s <strong>a way</strong>!</p><h2 id=code-a-long-ness>Code-a-long-ness</h2><p>These posts are not meant to be a code-a-long. There is enough detail to understand what needs to be done, and I give you the info about how to approach the problem. Other than that the solutions to how I decided to do it are available, but I do not go line-by-line through the code at any point.</p><h3 id=python-syntax>Python syntax</h3><p>On top of the usual intermediate to expert python understanding there are a few topics/syntax you may not have encountered you will need to understand to be able to read the code</p><h4 id=list-comprehensions>List comprehensions</h4><p>A list comprehension syntactically shorter way to produce a list of values with a simple calculation. It is intended to replace the design pattern of:</p><ol><li>instantiating an empty list</li><li>Iterate and store values in the list</li><li>return or use list values.</li></ol><p>For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>result <span style=color:#f92672>=</span> [] <span style=color:#75715e># 1. Initialize empty list</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. Iterate and store values in the list</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> number <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>): <span style=color:#75715e># Square numbers from 0-9 and add them to the result list</span>
</span></span><span style=display:flex><span>    result<span style=color:#f92672>.</span>append(number<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(result) <span style=color:#75715e># 3. Return or use list values</span>
</span></span></code></pre></div><p>Can be shortened to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>result <span style=color:#f92672>=</span> [number <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>for</span> number <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>)] <span style=color:#75715e># Steps 1-2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(result) <span style=color:#75715e># 3. Return or use list values</span>
</span></span></code></pre></div><p>which produces:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>25</span>, <span style=color:#ae81ff>36</span>, <span style=color:#ae81ff>49</span>, <span style=color:#ae81ff>64</span>, <span style=color:#ae81ff>81</span>]
</span></span></code></pre></div><p>It does exactly the same as the above example, it is just shorter. The basic syntax is <code>[operation for variable in iterable]</code> Were operation is the calculation (or function) being run, variable is the name for the temporary iteration variable made, and iterable is some form of iterable (list, generator, set etc.). We can also do this conditionally, so for example if we wanted to only include even numbers we could do:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>evens <span style=color:#f92672>=</span> [number <span style=color:#66d9ef>for</span> number <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>) <span style=color:#66d9ef>if</span> number <span style=color:#f92672>%</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>print(evens) <span style=color:#75715e># [0, 2, 4, 6, 8]</span>
</span></span></code></pre></div><p>And we can do an if-else statement using:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>evens <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;even&#34;</span> <span style=color:#66d9ef>if</span> number <span style=color:#f92672>%</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;odd&#34;</span> <span style=color:#66d9ef>for</span> number <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>)]
</span></span><span style=display:flex><span>print(evens) <span style=color:#75715e># [&#39;even&#39;, &#39;odd&#39;, &#39;even&#39;, &#39;odd&#39;, &#39;even&#39;, &#39;odd&#39;, &#39;even&#39;, &#39;odd&#39;, &#39;even&#39;, &#39;odd&#39;]</span>
</span></span></code></pre></div><h4 id=type-hints>Type hints</h4><p>Type hints are a way in python to specify the <strong>intended</strong> type of a variable (not enforced just highly suggested). This works by having a colon, then the type declaration for each varaible/parameter/attribute. You can even include details about return types in functions with <code>def function_name(parameter) -> return_type</code> For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>age <span style=color:#f92672>=</span> <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>greet</span>(name):
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Hello </span><span style=color:#e6db74>{</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Animal</span>:
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>def</span> __init__(self, name):
</span></span><span style=display:flex><span>      self<span style=color:#f92672>.</span>name <span style=color:#f92672>=</span> name
</span></span></code></pre></div><p>Can be converted to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>age:int <span style=color:#f92672>=</span> <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>greet</span>(name:str) <span style=color:#f92672>-&gt;</span> str:
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Hello </span><span style=color:#e6db74>{</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Animal</span>:
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>def</span> __init__(self, name:str):
</span></span><span style=display:flex><span>      self<span style=color:#f92672>.</span>name:str <span style=color:#f92672>=</span> name
</span></span></code></pre></div><p>This gives an indication to people running your code which data types they should use. Along with this there are a few special types to keep in mind (most need to be imported from the typing module):</p><table><thead><tr><th>Type</th><th>Usage</th><th>Example</th></tr></thead><tbody><tr><td>Union</td><td>To indicate one type <strong>OR</strong> another</td><td>A variable called age which can be a string or int could be given as <code>age:Union[str,int] = "Twenty Three"</code></td></tr><tr><td>Literal</td><td>The avlue for the variable is literally one of the subscripted values</td><td>x is 2, 4 or 6 <strong>only</strong> <code>x:Literal[2,4,6]</code></td></tr><tr><td>Tuple</td><td>A tuple is an imutable data type similar to a list, this can mean a tuple, or is used to indicate multiple return values</td><td>The function <code>func()</code> returns an int and a bool in that order <code>def func() -> Tuple[int, bool</code></td></tr><tr><td>List</td><td>A list is a collection. Collections can be subscripted to tell you what&rsquo;s inside</td><td>users is a list of list of strings <code>users:List[List[str]] = [["kieran"],["James"]]</code></td></tr><tr><td>Callable</td><td>This means any object that has a <code>__call__()</code> method including functions (yes they are objects)</td><td>Passing the function <code>do_stuff()</code> to <code>time(func:Callable)</code> so it can run it and time it <code>time(do_stuff)</code></td></tr></tbody></table><h4 id=dataclasses>Dataclasses</h4><p>Dataclasses are a special way to define classes in python. They help make classes more efficient, but have some caveats (that I find are positives), namely all your attributes must be defined with type hints. For example here is a <code>User</code> class the typical python way:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span>:
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>def</span> __init__(self, name, age, birthday):
</span></span><span style=display:flex><span>      self<span style=color:#f92672>.</span>name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>      self<span style=color:#f92672>.</span>age <span style=color:#f92672>=</span> age
</span></span><span style=display:flex><span>      self<span style=color:#f92672>.</span>birthday <span style=color:#f92672>=</span> birthday
</span></span></code></pre></div><p>Now here is the same class in a dataclass:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> dataclasses <span style=color:#f92672>import</span> dataclass
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@dataclass</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span>:
</span></span><span style=display:flex><span>      name: str
</span></span><span style=display:flex><span>      age:int
</span></span><span style=display:flex><span>      birthday:datetime
</span></span></code></pre></div><p>The handy thing about this is that the birthday attribute was not clear in the original example. It could have been a 3 value tuple for year, month, day (<code>(1998,10,28)</code>), a formatted string <code>"28-10-1998"</code> or any other types. But now users know what type they <strong>should use</strong> (this is not enforced).</p><p>If you need to run code after a class instance is created you can use <code>__post_init__(self)</code>.</p><h4 id=lambdas>Lambdas</h4><p>Lambdas are a way in python to declare anonymous functions. What this means is you can assign a function call to a variable. So for example let&rsquo;s take the simplest case, a function that takes in a name and returns a greeting string using the name:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>generate_greeting</span>(name: str):
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Hello </span><span style=color:#e6db74>{</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>We can make this a lambda like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>generate_greeting <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> name: <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Hello </span><span style=color:#e6db74>{</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>Lambdas follow the form of:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>lambda</span> arguments: <span style=color:#75715e># Function body</span>
</span></span></code></pre></div><p>Lambdas always return whatever value is evaluated in the function body. So since we evaluated the string, we get the string back at the end. We can then call it the same way:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>generate_greeting(<span style=color:#e6db74>&#34;Kieran&#34;</span>) <span style=color:#75715e># &#34;Hello Kieran&#34;</span>
</span></span></code></pre></div><p>This comes in handy in cases where something needs a <code>Callable</code> objet, but you don&rsquo;t need to call it more than once. One example of this is in dataclasses. For some data types (like <code>List</code>s) you need to provide a <code>Callable</code> object (object with a <code>__call__()</code> funtion) to initialize an attribute that is a list. So you can do this with a lambda that returns an empty list like so:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> dataclasses <span style=color:#f92672>import</span> dataclass, field
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>empty_list <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> : []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@dataclass</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Student</span>:
</span></span><span style=display:flex><span>   grades:List[int] <span style=color:#f92672>=</span> field(default_factory<span style=color:#f92672>=</span>empty_list) <span style=color:#75715e># Initialize Student.grades to an empty list</span>
</span></span></code></pre></div><h2 id=project-setup>Project setup</h2><p>For the rest of this post we are just going to setup our code, and talk about how the code is setup. We need to get some of the boring stuff out of the way first. I want to create this project so it can be installed and messed with easily. With python you install packages with pip.</p><h3 id=how-pip-works>How pip works</h3><p>Pip works with specially formatted python packages to install them to be used on your system. These packages can be stored locally and installed from source files (projects that have a <code>setup.py</code>), or they can be installed remotely from <a href=https://pypi.org/>pypi</a>.</p><p>This format has a bunch of stuff that goes into it, so instead of going through everything we&rsquo;re going to use a template. Specifically we&rsquo;re going to use <a href=https://github.com/canadian-coding/python-package-template>this template</a> I created a while back. It&rsquo;s a bit older, but works well for projects like this. If you are following along (or just interested), you can either download a zip of the code, or if you have a github account you can copy the files as a template directly by hitting <code>Use this Template</code>:</p><p><img src=../../../img/blog/hhttpp/package_templates.png alt></p><h3 id=customizing-the-template>Customizing the template</h3><p>This template gives you <strong>a ton</strong> of features, we don&rsquo;t need a bunch, so I&rsquo;m going to delete a bunch of the files. After getting rid of them our project looks like this:</p><pre tabindex=0><code>â”œâ”€â”€ ğŸ“.github/
â”‚   â””â”€â”€ ğŸ“workflows/
â”‚       â”œâ”€â”€ ğŸ“ƒrelease.yml
â”‚       â””â”€â”€ ğŸ“ƒtest-suite.yml
â”œâ”€â”€ ğŸ“hhttpp/
â”‚   â”œâ”€â”€ ğŸ“„__init__.py
â”‚   â”œâ”€â”€ ğŸ“„__main__.py
â”‚   â”œâ”€â”€ ğŸ“„classes.py
â”‚   â””â”€â”€ ğŸ“„cli.py
â”œâ”€â”€ ğŸ“tests/
â”‚   â””â”€â”€ ğŸ“„classes_test.py
â”œâ”€â”€ ğŸ—‹.gitignore
â”œâ”€â”€ ğŸ“ƒREADME.md
â””â”€â”€ ğŸ“„setup.py
</code></pre><p>So a quick breakdown for now we won&rsquo;t need to worry about <code>ğŸ“.github/</code>, <code>ğŸ“tests/</code>, or <code>ğŸ—‹.gitignore</code>.</p><p>So to start with <code>ğŸ“„setup.py</code> is the file where we will configure our project so it can be installed and how python should treat it when it&rsquo;s installed. We won&rsquo;t need to touch this file anymore after the initial setup!</p><p>Now onto the good stuff. <code>ğŸ“hhttpp/</code> contains all the code that will be part of our package. We have 4 files inside:</p><ul><li>ğŸ“„__init__.py; Just a required file to be able to install the package, there&rsquo;s nothing in there except a version indicaor</li><li>ğŸ“„__main__.py; Allows people to run the server using <code>python -m hhttpp</code></li><li>ğŸ“„classes.py; Contains our classes that define our HTTP server</li><li>ğŸ“„cli.py; Will be filled out later, but will contain code to let people use the CLI</li></ul><p>This sets us up well for being able to start building our package!</p></div><div class="card text-center"><div class=share-icons><h2>Share the article</h2><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fschulichignite.com%2fblog%2fhhttpp%2fseries-introduction%2f" target=_blank><i class="bi bi-facebook"></i></a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fschulichignite.com%2fblog%2fhhttpp%2fseries-introduction%2f" target=_blank><i class="bi bi-linkedin"></i></a>
<a href="https://twitter.com/intent/tweet?text=Check%20out%20this%20post%20from%20schulich%20ignite%3A%0Ahttps%3a%2f%2fschulichignite.com%2fblog%2fhhttpp%2fseries-introduction%2f" target=_blank><i class="bi bi-twitter"></i></a></div><a href=../../../blog/index.xml target=_blank class=p-3>or subscribe to the blog with RSS <i class="bi bi-rss-fill"></i></a></div></div></div></div></div></section></body><footer class="footer sticky-bottom" style=position:fixed;background-color:#ffcdae><div class=container><div class=row><a href=https://www.instagram.com/schulichignite target=_blank rel="noopener noreferrer"><i class="bi bi-instagram is-large"></i></a>
<a href=https://www.youtube.com/channel/UC7tNvdbu952HOUl_4nK7iww target=_blank rel="noopener noreferrer"><i class="bi bi-youtube is-large"></i></a>
<a href=https://vm.tiktok.com/ZSHPbWU3/ target=_blank rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentcolor" class="bi bi-tiktok is-large mt-3" viewBox="0 0 16 16"><path d="M9 0h1.98c.144.715.54 1.617 1.235 2.512C12.895 3.389 13.797 4 15 4v2c-1.753.0-3.07-.814-4-1.829V11A5 5 0 116 6v2a3 3 0 103 3V0z"/></svg></a><a href=https://www.facebook.com/SchulichIgnite/ target=_blank rel="noopener noreferrer"><i class="bi bi-facebook is-large"></i></a>
<a href=https://linkedin.com/company/schulich-ignite/ target=_blank rel="noopener noreferrer"><i class="bi bi-linkedin is-large"></i></a>
<a href=https://discord.gg/F3Qjqqj target=_blank rel="noopener noreferrer"><i class="bi bi-discord is-large"></i></a></div></div></footer><script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js integrity=sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js integrity="sha512-bgHRAiTjGrzHzLyKOnpFvaEpGzJet3z4tZnXGjpsCcqOnAH6VGUx9frc5bcIhKTVLEiCO6vEhNAgx5jtLUYrfA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/django.min.js integrity="sha512-1NHUMVlHsFnOe0Q36JMbBrNrjVcMdue2occC2xHWYXo7epa3YR54ZibI1G4I+tnJKBGNib11d8JzOElMfUSpYg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/http.min.js integrity="sha512-4Rcwpn+xUuCDufCycA9UtpmboCxNHysWy23e45PJBQeh7m6Kno5/oQ4T5SmbmSAAZiDsm/IsX1IJwsOjy6ob0g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/http.min.js integrity="sha512-4Rcwpn+xUuCDufCycA9UtpmboCxNHysWy23e45PJBQeh7m6Kno5/oQ4T5SmbmSAAZiDsm/IsX1IJwsOjy6ob0g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>hljs.addPlugin(new CopyButtonPlugin),hljs.highlightAll(),hljs.initLineNumbersOnLoad()</script><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@9/dist/mermaid.esm.min.mjs';
    
    let mermaidConfig = {
    startOnLoad: true,
    "theme": "base",
        "themeVariables": {
            "primaryColor": "#ffde59",
            "primaryTextColor": "#d14b3b",
            "primaryBorderColor": "#7C0000",
            "lineColor": "#F8B229",
            "secondaryColor": "#fff",
            "tertiaryColor": "#d14b3b"
        }
    }
    mermaid.initialize(mermaidConfig, '.language-mermaid');
</script><script>window.onload=()=>{words={},articleContent=document.getElementById("article-content").innerHTML,contentSections=articleContent.match(/<p>(.*?)<\/p>|<ul>(.*?)<\/ul>|<ol>(.*?)<\/ol>/g),contentSections.forEach(e=>{for(word in words)searchMask=` ${word} |^${word} |${word}$| ${word}$|${word},`,regEx=new RegExp(searchMask,"igm"),newval=`${e}`.replace(regEx,` <a href="${words[word][0]}" target="_blank" data-toggle="tooltip" data-placement="top" title="${words[word][1]}">${word}</a> `),document.getElementById("article-content").innerHTML=document.getElementById("article-content").innerHTML.replace(e,newval)}),$(function(){$('[data-toggle="tooltip"]').tooltip()})}</script></html>