<!doctype html><html style=overflow-x:hidden><head><meta charset=utf-8><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","author":"Schulich Ignite","name":"Making Things Small","dateCreated":"2023-77-06","text":"Compression is the art of taking some data and making it smaller. If you want more details about common compression schemes take a look at our definition page for compression.","image":"\/img\/blog\/compression\/hero.jpeg"}</script><title>Making Things Small | Schulich Ignite</title><link rel="shortcut icon" href=https://schulichignite.com/img/favicon.ico type=image/x-icon><link rel=icon href=https://schulichignite.com/img/favicon.ico type=image/x-icon><meta property="og:title" content=" Making Things Small | Schulich Ignite Blog "><meta property="og:type" content="website"><meta property="og:url" content=" https://schulichignite.com/blog/making-things-small/ "><meta property="og:image" content="/img/blog/compression/hero.jpeg "><meta name=Description content=" Making Things Small; Compression is the art of taking some data and making it smaller. If you want more details about common compression schemes take a look at our definition page for compression. "><meta property="og:description" content=" Making Things Small; Compression is the art of taking some data and making it smaller. If you want more details about common compression schemes take a look at our definition page for compression. "><link href="https://fonts.googleapis.com/css2?family=Raleway:wght@900&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Encode+Sans+Semi+Condensed:wght@900&display=swap" rel=stylesheet><link href=https://unpkg.com/video.js@7/dist/video-js.min.css rel=stylesheet><link href=https://unpkg.com/@videojs/themes@1/dist/sea/index.css rel=stylesheet><link rel=stylesheet href=https://schulichignite.com/css/index.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/vs2015.min.css integrity="sha512-mtXspRdOWHCYp+f4c7CkWGYPPRAhq9X+xCvJMUBVAb6pqA4U8pxhT3RWT3LP3bKbiolYL2CkL1bSKZZO4eeTew==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css></head><nav class="navbar sticky-top navbar-expand-lg navbar-dark bg-dark"><a class=navbar-brand href=../../><img src=https://schulichignite.com/img/logos/ignite.svg width=40 height=60 alt="Schulich ignite logo">
<span class=brand-name>Schulich Ignite</span></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Sessions</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=../../beginner>Ignite Beginner</a>
<a class=dropdown-item href=../../flare>Ignite Flare</a>
<a class=dropdown-item href=../../scorch>Ignite Scorch</a></div></li></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Student links</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href="https://docs.google.com/spreadsheets/d/1YwXV-09PoVZI0_yPvmnEHCQpg4NaA2JGvyP-xfdyBCM/edit?usp=sharing" target=_blank rel="noopener noreferrer">Ignite Points spreadsheet</a><div class=dropdown-divider></div><a class=dropdown-item href target=_blank rel="noopener noreferrer">Submit - Bug Busters</a>
<a class=dropdown-item href=https://docs.google.com/forms/d/1H59Zvw9gNdKFATBSTlPXxLumVWx5eSylphy8pIvEep8/edit target=_blank rel="noopener noreferrer">Submit - Pythonic Lava</a>
<a class=dropdown-item href=https://docs.google.com/forms/d/12c0RPKAcboEoGlcK7XMZomHOvv04a2oAHIh0SGG9wkM/edit target=_blank rel="noopener noreferrer">Submit - Flare</a>
<a class=dropdown-item href=https://docs.google.com/forms/d/15iRE_US5KRnIfnjGOwRn0fcp-RNCIismhKnN4m6b64Q/edit target=_blank rel="noopener noreferrer">Submit - Scorch</a></div></li><li class=nav-item><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Media</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=../../blog>Blog</a>
<a class=dropdown-item href=../../language>Languages</a>
<a class=dropdown-item href=../../definitions>Definitions</a></div></li></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=../../mission>Our Mission</a>
<a class=dropdown-item href=../../team>Our Team</a></li><li class=nav-item><a class=nav-link href=../../contact>Contact</a></li></ul></div></nav><body><div class=diagonal-header><div class=mainheader>Blog</div><div class="subheader dates d-none d-sm-block"><span class=long-dates>Monday, Jul 3, 2023</span>
<span class=short-dates>07/03/23</span></div></div><section class=section><img class="card-img-top large-image blog-hero-image" src=../../img/blog/compression/hero.jpeg><div class=container><div class=row><div class="card no-background"><div class=card-body><h1 class=card-title>Making Things Small</h1><h3 style=font-size:1em;color:#787878>An introduction to compression</h3><a class="btn btn-secondary my-2" href=../../blog>&larr; Go back to blog</a><div id=article-info class=card><div class=row><div class=col-md-6><div class=card-body><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#list-and-dictionary-comprehensions>List and dictionary comprehensions</a></li><li><a href=#lossless-vs-lossy>Lossless vs Lossy</a><ul><li><a href=#lossless>Lossless</a></li><li><a href=#lossy>Lossy</a></li></ul></li><li><a href=#simple-text-example>Simple text example</a><ul><li><a href=#where-it-gets-complicated>Where it gets complicated</a></li><li><a href=#some-improvements>Some improvements</a></li><li><a href=#an-even-better-option>An even Better option</a></li></ul></li><li><a href=#images>Images</a><ul><li><a href=#the-algorithm-1>The algorithm</a></li></ul></li><li><a href=#file-types>File types</a></li><li><a href=#video>Video</a></li><li><a href=#real-world-compression-systems>Real world compression systems</a></li></ul></nav></p></div></div><div class=col-md-6><div class=card-body><p class=card-text><i class="bi bi-calendar2-week-fill"></i> <time>Monday, Jul 3, 2023</time></p><p class=card-text><i class="bi bi-stopwatch-fill"></i><em>~18 Minute Read</em><br><em><i class="bi bi-tags-fill"></i></em>
<a href=https://schulichignite.com/tags/optimization/>optimization</a>,
<a href=https://schulichignite.com/tags/theory/>theory</a>,
<a href=https://schulichignite.com/tags/terminology/>terminology</a></p><i class="bi bi-file-code-fill text-primary"></i>
<a href=https://schulichignite.com/language/python/>python</a><br><em>Difficulty:</em>
<span class=text-primary><a id=difficulty-tooltip href=https://schulichignite.com/difficulty/scorch/ target=_blank data-toggle=tooltip data-placement=top data-original-title="<strong>You should know these terms/topics for this article</strong><ul><li><a target='_blank' href='https://schulichignite.com/definitions/loops/'>Loops</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/conditionals/'>Conditionals</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/functions/'>Functions</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/variables/'>Variables</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/data-types/'>Data Types</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/classes/'>Classes</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/packages/'>Packages</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/paths/'>Paths</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/api/'>Application Programming Interface's</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/http/'>HyperText Transfer Protocol</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/webpages/'>Webpages</a></li><li><a target='_blank' href='https://schulichignite.com/definitions/encoding/'>encoding</a></li>" data-html=true>scorch</a></span></strong><h4>Author(s) information</h4><div id=author-information><a href=https://schulichignite.com/authors/kieran-wood/ target=_blank rel="noopener noreferrer"><img width=100rem src=../../img/blog/avatars/kieran.jpg alt></a><h6 class=card-title><a href=https://schulichignite.com/authors/kieran-wood/ target=_blank rel="noopener noreferrer"><br>Kieran Wood</a></h6><div id=author-icons><a href=mailto:kieran@canadiancoding.ca><i class="bi bi-envelope-fill"></i></a>
<a href=https://github.com/descent098 target=_blank><i class="bi bi-github"></i></a>
<a href=https://linkedin.com/in/kieran-wood target=_blank><i class="bi bi-linkedin"></i></a>
<a href=https://kieranwood.ca target=_blank><i class="bi bi-globe"></i></a></div><div class=text-primary style=max-width:40ch><p>I&rsquo;m a computer science major, with a minor in philosophy. I love to do open source work, especially in scripting, automation, web development, API&rsquo;s, CLI&rsquo;s and dev ops!</p></div></div></div></div></div></div></div><hr><div id=article-content class="card-text blog-text"><p>Compression is the art of taking some data and making it smaller. If you want more details about common compression schemes take a look at our <a href=../../definitions/compression>definition page for compression</a>. This article is instead going to focus on showing you compression with code examples, and simple custom compression schemes in python!</p><p>The repository for the full code examples can be found <a href=https://github.com/Descent098/compression>here</a></p><h2 id=list-and-dictionary-comprehensions>List and dictionary comprehensions</h2><p>On top of the basic python syntax the code examples use a few concepts you should know.</p><p>A list comprehension syntactically shorter way to produce a list of values with a simple calculation. It is intended to replace the design pattern of:</p><ol><li>instantiating an empty list</li><li>Iterate and store values in the list</li><li>return or use list values.</li></ol><p>For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>result <span style=color:#f92672>=</span> [] <span style=color:#75715e># 1. Initialize empty list</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. Iterate and store values in the list</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> number <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>): <span style=color:#75715e># Square numbers from 0-9 and add them to the result list</span>
</span></span><span style=display:flex><span>    result<span style=color:#f92672>.</span>append(number<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(result) <span style=color:#75715e># 3. Return or use list values</span>
</span></span></code></pre></div><p>Can be shortened to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>result <span style=color:#f92672>=</span> [number <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>for</span> number <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>)] <span style=color:#75715e># Steps 1-2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(result) <span style=color:#75715e># 3. Return or use list values</span>
</span></span></code></pre></div><p>which produces:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>25</span>, <span style=color:#ae81ff>36</span>, <span style=color:#ae81ff>49</span>, <span style=color:#ae81ff>64</span>, <span style=color:#ae81ff>81</span>]
</span></span></code></pre></div><p>It does exactly the same as the above example, it is just shorter. The basic syntax is <code>[operation for variable in iterable]</code> Were operation is the calculation (or function) being run, variable is the name for the temporary iteration variable made, and iterable is some form of iterable (list, generator, set etc.). We can also do this conditionally, so for example if we wanted to only include even numbers we could do:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>evens <span style=color:#f92672>=</span> [number <span style=color:#66d9ef>for</span> number <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>) <span style=color:#66d9ef>if</span> number <span style=color:#f92672>%</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>print(evens) <span style=color:#75715e># [0, 2, 4, 6, 8]</span>
</span></span></code></pre></div><p>And we can do an if-else statement using:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>evens <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;even&#34;</span> <span style=color:#66d9ef>if</span> number <span style=color:#f92672>%</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;odd&#34;</span> <span style=color:#66d9ef>for</span> number <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>)]
</span></span><span style=display:flex><span>print(evens) <span style=color:#75715e># [&#39;even&#39;, &#39;odd&#39;, &#39;even&#39;, &#39;odd&#39;, &#39;even&#39;, &#39;odd&#39;, &#39;even&#39;, &#39;odd&#39;, &#39;even&#39;, &#39;odd&#39;]</span>
</span></span></code></pre></div><p>We can do the same thing with dictionaries. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>names <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Kieran&#34;</span>, <span style=color:#e6db74>&#34;Frank&#34;</span>, <span style=color:#e6db74>&#34;Amy&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>users <span style=color:#f92672>=</span> dict()
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> name <span style=color:#f92672>in</span> names:
</span></span><span style=display:flex><span>    users[name] <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;new_user&#34;</span>:<span style=color:#66d9ef>True</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(users) <span style=color:#75715e># {&#39;Kieran&#39;: {&#39;new_user&#39;: True}, &#39;Frank&#39;: {&#39;new_user&#39;: True}, &#39;Amy&#39;: {&#39;new_user&#39;: True}}</span>
</span></span></code></pre></div><p>Can be shortened to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>names <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Kieran&#34;</span>, <span style=color:#e6db74>&#34;Frank&#34;</span>, <span style=color:#e6db74>&#34;Amy&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>users <span style=color:#f92672>=</span> {name:{<span style=color:#e6db74>&#34;new_user&#34;</span>:<span style=color:#66d9ef>True</span>} <span style=color:#66d9ef>for</span> name <span style=color:#f92672>in</span> names}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(users) <span style=color:#75715e># {&#39;Kieran&#39;: {&#39;new_user&#39;: True}, &#39;Frank&#39;: {&#39;new_user&#39;: True}, &#39;Amy&#39;: {&#39;new_user&#39;: True}}</span>
</span></span></code></pre></div><h2 id=lossless-vs-lossy>Lossless vs Lossy</h2><p>The other concept you should be aware of is that there are two different common ways of doing compression depending on what you need it for. Lossless and lossy. The text algorithm we will cover is lossless, the image one is lossy.</p><h3 id=lossless>Lossless</h3><p>Lossless formats are what we&rsquo;re used to. They take in some data, compress it, and at the end you can decompress it to get back exactly the data you put in. This is handy for things like text (you usually don&rsquo;t want just <strong>some</strong> of a text file), or images that need high fidelity. PNG is a format that is a lossless form of compression.</p><h3 id=lossy>Lossy</h3><p>Lossy is unlike the systems we&rsquo;ve seen before. With typical compression we want to get back <strong>exactly</strong> what we had before we compressed it. With lossy compression we want to be &ldquo;close&rdquo;. Imagine you have a large image on a small screen, let&rsquo;s say a 1920x1080px image on a 480x720px screen. If we were to resize the image and in the process remove 1/8 of the pixels and just stich together a smaller but &ldquo;close enough&rdquo; version of the image, most people wouldn&rsquo;t notice.</p><p>Formats like JPG are lossy. They basically create versions of images that are &ldquo;close enough&rdquo; to the original source images. This can cause some issues like <a href=https://en.wikipedia.org/wiki/Compression_artifact>artifacts</a>, a good quick explainer about this can be found <a href="https://www.youtube.com/watch?v=yBX8GFqt6GA">here as a video</a>. Lossy schemes are good for large data like images and videos. Especially when sending the data over a network!</p><h2 id=simple-text-example>Simple text example</h2><p>The most common thing we will want to compress is text. We&rsquo;re going to come up with a super simple algorithm to do this.</p><p>There are a few assumptions we&rsquo;re making for this to work somewhat well:</p><ol><li>Text is in english</li><li>The text does not have any numbers</li><li>The text is general (if it&rsquo;s a programming language you want to pick different common words)</li><li>The text is at least a few paragraphs (if it&rsquo;s super short compression is unlikely to be helpful)</li></ol><p>With this the main idea is that we can use the indicies of a list to replace words. So if we have the list <code>words = ["orange", "apple", "mango"]</code> then we can take text like <code>text = "I love oranges, they are about on par with apples, but they are much better than mangos"</code> and replace each occurance of the word with it&rsquo;s index in the list. So the text would become <code>text = "I love 0s, they are about on par with 1s, but they are much better than 3s"</code>, <strong>each letter and number is a byte</strong> (8 bits), so we saved 13 bytes of space in this example.</p><p><img src=../../img/blog/compression/io-example.png alt></p><p>The problem is that most people don&rsquo;t just talk about fruit, so we need to create a list of words that is useful to us. To keep it simple we can just take the 100 most common words in english and hope most text will have them. So the algorithm we&rsquo;re going to use is this:</p><ol><li>Create a list of the most common english words sorted by length (longest first), include the lowercase and capitalized versions</li><li>Loop over the list of words and replace each occurance of a word in the input text with it&rsquo;s index in the common words list</li></ol><p>So the function would look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>compress_by_common_words</span>(input_text: str) <span style=color:#f92672>-&gt;</span> str:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Takes in some input text and returns the compressed form&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 1. Create a list of the most common english words</span>
</span></span><span style=display:flex><span>    common_words <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;compression&#34;</span>, <span style=color:#e6db74>&#34;efficient&#34;</span>,<span style=color:#e6db74>&#34;encoding&#34;</span>,<span style=color:#e6db74>&#34;data&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;the&#34;</span>,<span style=color:#e6db74>&#34;at&#34;</span>,<span style=color:#e6db74>&#34;there&#34;</span>,<span style=color:#e6db74>&#34;some&#34;</span>,<span style=color:#e6db74>&#34;my&#34;</span>,<span style=color:#e6db74>&#34;of&#34;</span>,<span style=color:#e6db74>&#34;be&#34;</span>,<span style=color:#e6db74>&#34;use&#34;</span>,<span style=color:#e6db74>&#34;her&#34;</span>,<span style=color:#e6db74>&#34;than&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;and&#34;</span>,<span style=color:#e6db74>&#34;this&#34;</span>,<span style=color:#e6db74>&#34;an&#34;</span>,<span style=color:#e6db74>&#34;would&#34;</span>,<span style=color:#e6db74>&#34;first&#34;</span>,<span style=color:#e6db74>&#34;a&#34;</span>,<span style=color:#e6db74>&#34;have&#34;</span>,<span style=color:#e6db74>&#34;each&#34;</span>,<span style=color:#e6db74>&#34;make&#34;</span>,<span style=color:#e6db74>&#34;water&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;to&#34;</span>,<span style=color:#e6db74>&#34;from&#34;</span>,<span style=color:#e6db74>&#34;which&#34;</span>,<span style=color:#e6db74>&#34;like&#34;</span>,<span style=color:#e6db74>&#34;been&#34;</span>,<span style=color:#e6db74>&#34;in&#34;</span>,<span style=color:#e6db74>&#34;or&#34;</span>,<span style=color:#e6db74>&#34;she&#34;</span>,<span style=color:#e6db74>&#34;him&#34;</span>,<span style=color:#e6db74>&#34;call&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;is&#34;</span>,<span style=color:#e6db74>&#34;one&#34;</span>,<span style=color:#e6db74>&#34;do&#34;</span>,<span style=color:#e6db74>&#34;into&#34;</span>,<span style=color:#e6db74>&#34;who&#34;</span>,<span style=color:#e6db74>&#34;you&#34;</span>,<span style=color:#e6db74>&#34;had&#34;</span>,<span style=color:#e6db74>&#34;how&#34;</span>,<span style=color:#e6db74>&#34;time&#34;</span>,<span style=color:#e6db74>&#34;oil&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;that&#34;</span>,<span style=color:#e6db74>&#34;by&#34;</span>,<span style=color:#e6db74>&#34;their&#34;</span>,<span style=color:#e6db74>&#34;has&#34;</span>,<span style=color:#e6db74>&#34;its&#34;</span>,<span style=color:#e6db74>&#34;it&#34;</span>,<span style=color:#e6db74>&#34;word&#34;</span>,<span style=color:#e6db74>&#34;if&#34;</span>,<span style=color:#e6db74>&#34;look&#34;</span>,<span style=color:#e6db74>&#34;now&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;he&#34;</span>,<span style=color:#e6db74>&#34;but&#34;</span>,<span style=color:#e6db74>&#34;will&#34;</span>,<span style=color:#e6db74>&#34;two&#34;</span>,<span style=color:#e6db74>&#34;find&#34;</span>,<span style=color:#e6db74>&#34;was&#34;</span>,<span style=color:#e6db74>&#34;not&#34;</span>,<span style=color:#e6db74>&#34;up&#34;</span>,<span style=color:#e6db74>&#34;more&#34;</span>,<span style=color:#e6db74>&#34;long&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;for&#34;</span>,<span style=color:#e6db74>&#34;what&#34;</span>,<span style=color:#e6db74>&#34;other&#34;</span>,<span style=color:#e6db74>&#34;write&#34;</span>,<span style=color:#e6db74>&#34;down&#34;</span>,<span style=color:#e6db74>&#34;on&#34;</span>,<span style=color:#e6db74>&#34;all&#34;</span>,<span style=color:#e6db74>&#34;about&#34;</span>,<span style=color:#e6db74>&#34;go&#34;</span>,<span style=color:#e6db74>&#34;day&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;are&#34;</span>,<span style=color:#e6db74>&#34;were&#34;</span>,<span style=color:#e6db74>&#34;out&#34;</span>,<span style=color:#e6db74>&#34;see&#34;</span>,<span style=color:#e6db74>&#34;did&#34;</span>,<span style=color:#e6db74>&#34;as&#34;</span>,<span style=color:#e6db74>&#34;we&#34;</span>,<span style=color:#e6db74>&#34;many&#34;</span>,<span style=color:#e6db74>&#34;number&#34;</span>,<span style=color:#e6db74>&#34;get&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;with&#34;</span>,<span style=color:#e6db74>&#34;when&#34;</span>,<span style=color:#e6db74>&#34;then&#34;</span>,<span style=color:#e6db74>&#34;no&#34;</span>,<span style=color:#e6db74>&#34;come&#34;</span>,<span style=color:#e6db74>&#34;his&#34;</span>,<span style=color:#e6db74>&#34;your&#34;</span>,<span style=color:#e6db74>&#34;them&#34;</span>,<span style=color:#e6db74>&#34;way&#34;</span>,<span style=color:#e6db74>&#34;made&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;they&#34;</span>,<span style=color:#e6db74>&#34;can&#34;</span>,<span style=color:#e6db74>&#34;these&#34;</span>,<span style=color:#e6db74>&#34;could&#34;</span>,<span style=color:#e6db74>&#34;may&#34;</span>,<span style=color:#e6db74>&#34;I&#34;</span>,<span style=color:#e6db74>&#34;said&#34;</span>,<span style=color:#e6db74>&#34;so&#34;</span>,<span style=color:#e6db74>&#34;people&#34;</span>,<span style=color:#e6db74>&#34;part&#34;</span>,
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 1.2 Add capitalized version of the words</span>
</span></span><span style=display:flex><span>    common_words <span style=color:#f92672>+=</span> [word<span style=color:#f92672>.</span>capitalize() <span style=color:#66d9ef>for</span> word <span style=color:#f92672>in</span> common_words]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 1.3 Sort by length; Longest word first</span>
</span></span><span style=display:flex><span>    common_words <span style=color:#f92672>=</span> sorted(common_words, key<span style=color:#f92672>=</span>len)[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 2. Loop over the list of words</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> input_text
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> word <span style=color:#f92672>in</span> common_words:
</span></span><span style=display:flex><span>        <span style=color:#75715e>## 2.1 Replace each occurance of a word in the input text with</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>## it&#39;s index in the common words list</span>
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> result<span style=color:#f92672>.</span>replace(word, str(common_words<span style=color:#f92672>.</span>index(word)))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span></code></pre></div><p>Now we have our code it&rsquo;s time to get some text, naturally I figured asking chat GPT to write a few paragraphs on compression would be a good example, so here&rsquo;s the code for testing our system:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>input_text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Compression is a fundamental technique used in various fields to reduce the size of data while preserving its essential information. In computer science and information technology, data compression plays a crucial role in storage, transmission, and processing of large amounts of information. By eliminating redundancy and exploiting patterns in data, compression algorithms can significantly reduce file sizes, resulting in more efficient use of storage space and faster data transfer over networks. From simple algorithms like run-length encoding to sophisticated methods like Huffman coding and Lempel-Ziv-Welch (LZW) algorithm, compression enables us to store and transmit data more effectively.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Compression algorithms employ different strategies to achieve efficient data compression. Lossless compression techniques ensure that the compressed data can be fully reconstructed back to its original form without any loss of information. These techniques are commonly used in applications where preserving the integrity of data is critical, such as archiving files, databases, and text documents. On the other hand, lossy compression methods trade off some degree of data fidelity for higher compression ratios. Such techniques are commonly used in multimedia applications like image, audio, and video compression, where the removal of non-essential information or imperceptible details can lead to significant reduction in file sizes while maintaining acceptable perceptual quality.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>The benefits of compression extend beyond just saving storage space and reducing transmission time. Compressed data also reduces the demand for computational resources and improves system performance. When processing large datasets, compressed files can be read and decompressed faster than their uncompressed counterparts, allowing for quicker access and analysis. Moreover, compression enables efficient streaming of multimedia content, making it possible to deliver high-quality videos and audio over bandwidth-constrained networks. By minimizing the amount of data that needs to be transmitted, compression contributes to a smoother and more efficient digital experience, whether it&#39;s browsing the web, downloading files, or streaming media.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>In summary, compression is a vital technique that enables efficient storage, transmission, and processing of data. It utilizes various algorithms and strategies to reduce file sizes while preserving data integrity or achieving perceptual quality. By minimizing storage requirements, improving data transfer speeds, and enhancing system performance, compression plays a central role in modern computing and communication systems, benefiting users across a wide range of applications.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Print info </span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Original Length of text = </span><span style=color:#e6db74>{</span>len(input_text)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>result <span style=color:#f92672>=</span> compress_by_common_words(input_text)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Length of compressed text = </span><span style=color:#e6db74>{</span>len(result)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><h3 id=where-it-gets-complicated>Where it gets complicated</h3><p>With this we get the output:</p><pre tabindex=0><code>Original Length of text = 2720
Length of compressed text = 2808
</code></pre><p>AAAAHHH, why is the &ldquo;compressed&rdquo; version longer? Well this is part of why compression algorithms are a bit complicated. Our method works, except we made 1 mistake, we ordered our list of common words by length. In theory this should save the most space because the longest words have the shortest indicies (i.e. compression is index 0 which should save 10 bytes per occurance). The problem is short words. For example &ldquo;a&rdquo; is index 207, this means we&rsquo;re actually adding 2 bytes for every occurance of &ldquo;a&rdquo;.</p><p><img src=../../img/blog/compression/a.png alt></p><h3 id=some-improvements>Some improvements</h3><p>When looking at the list of terms remove any term where the index is the same size, or has more digits than the length of text (i.e 12 for &ldquo;A&rdquo; would be rejected 103 for &ldquo;the&rdquo; would be rejected, but 12 for &ldquo;the&rdquo; would work). We can remove all 1 letter words because no matter what we need at least 1 number to represent them which means it will never be compressed. For example is &ldquo;A&rdquo; is given index 0 it still doesn&rsquo;t save any space, so we just don&rsquo;t include it. This code would be:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>is_word_longer_than_index</span>(word:str, index:int) <span style=color:#f92672>-&gt;</span> bool:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Takes in a word and an index indicator and makes sure the length of the word is longer than the digits in the index</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(word) <span style=color:#f92672>&gt;</span> len(str(index)):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>compress_by_common_words_improved</span>(input_text: str) <span style=color:#f92672>-&gt;</span> str:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;Takes in some input text and returns the compressed form&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 1. Create a list of the most common english words</span>
</span></span><span style=display:flex><span>    common_words <span style=color:#f92672>=</span> <span style=color:#f92672>...</span> <span style=color:#75715e># Same as last example, removed for brevity</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 1.2 Add capitalized version of the words</span>
</span></span><span style=display:flex><span>    common_words <span style=color:#f92672>+=</span> [word<span style=color:#f92672>.</span>capitalize() <span style=color:#66d9ef>for</span> word <span style=color:#f92672>in</span> common_words]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 1.3 Sort by length; Shortest word first</span>
</span></span><span style=display:flex><span>    common_words <span style=color:#f92672>=</span> sorted(common_words, key<span style=color:#f92672>=</span>len)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 1.4 Remove words that are shorter than their index</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> index, word <span style=color:#f92672>in</span> enumerate(common_words):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> is_word_longer_than_index(word, index):
</span></span><span style=display:flex><span>            common_words<span style=color:#f92672>.</span>pop(index)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 2. Loop over the list of words</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> input_text
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> word <span style=color:#f92672>in</span> common_words:
</span></span><span style=display:flex><span>        <span style=color:#75715e>## 2.1 Replace each occurance of a word in the input text with</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>## it&#39;s index in the common words list</span>
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> result<span style=color:#f92672>.</span>replace(word, str(common_words<span style=color:#f92672>.</span>index(word)))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span></code></pre></div><p>With this change we went from 206 items in <code>common_words</code> down to 190, but even though we only removed 16 words the reorganizing gave us the following output:</p><pre tabindex=0><code>Original Length of text = 2720
Length of compressed text = 2467
</code></pre><p>That&rsquo;s ~%10 space savings!</p><h3 id=an-even-better-option>An even Better option</h3><p>We wasted a lot of space in our <code>common_words</code> list on words that don&rsquo;t necessarily occur in the text (&ldquo;day&rdquo;, &ldquo;first&rdquo;, &ldquo;water&rdquo;, &ldquo;oil&rdquo;, etc.), it would be better if we only included words that occured in the text.</p><p>First let&rsquo;s look at some extra python stuff you will need to know to understand the code. If you skipped it read the <a href=#list-and-dictionary-comprehensions>comprehension section</a> from the beginning of the article as well.</p><p><code>Counter</code>s are a data type included by default in python. They can be used to count the occurences of items in collections (lists, strings etc.). So for example if I had a list of strings representing the results of how people voted for their favourite format of content I could then count the results using:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> collections <span style=color:#f92672>import</span> Counter
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>responses <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;video&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;audio&#34;</span>, <span style=color:#e6db74>&#34;text&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(Counter(responses))
</span></span></code></pre></div><p>Which results in <code>Counter({'audio': 18, 'video': 12, 'text': 12})</code>.</p><h4 id=the-algorithm>The Algorithm</h4><p>So our compression algorithm is:</p><ol><li>Create a dictionary of every word in the text with their number of occurences in the text</li><li>Filter the dictionary so that only items with 2 or more occurences are in the resulting list, then sort by length (longest first)</li><li>Remove any term where the index is the same size, or has more digits than the length of text</li><li>Loop over the list of words and replace each occurance of a word in the input text with it&rsquo;s index in the common words list</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> string
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> Tuple, List
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> collections <span style=color:#f92672>import</span> Counter
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>compress_with_counter</span>(input_text:str) <span style=color:#f92672>-&gt;</span> Tuple[str, List[str]]:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Compression using the counter method</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 1. Create dictionary of word occurences</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 1.1 Remove punctuation from input text</span>
</span></span><span style=display:flex><span>    counter_text <span style=color:#f92672>=</span> input_text<span style=color:#f92672>.</span>translate(str<span style=color:#f92672>.</span>maketrans(<span style=color:#e6db74>&#39;&#39;</span>,<span style=color:#e6db74>&#39;&#39;</span>,string<span style=color:#f92672>.</span>punctuation,))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 1.2 Split input text into a list of words so they can be counted</span>
</span></span><span style=display:flex><span>    counter_text <span style=color:#f92672>=</span> counter_text<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34; &#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 1.3 Count occurances of words in the text</span>
</span></span><span style=display:flex><span>    counter <span style=color:#f92672>=</span> Counter(counter_text)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 2. Filter to only terms with 2 or more items</span>
</span></span><span style=display:flex><span>    terms <span style=color:#f92672>=</span> {x: count <span style=color:#66d9ef>for</span> x, count <span style=color:#f92672>in</span> counter<span style=color:#f92672>.</span>items() <span style=color:#66d9ef>if</span> count <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>2</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 2.1 Sort words by length; longest first</span>
</span></span><span style=display:flex><span>    words <span style=color:#f92672>=</span> sorted(list(terms<span style=color:#f92672>.</span>keys()), key<span style=color:#f92672>=</span>len)[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 3. Remove words that are shorter than their index</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> index, word <span style=color:#f92672>in</span> enumerate(words):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> is_word_longer_than_index(word, index):
</span></span><span style=display:flex><span>            words<span style=color:#f92672>.</span>remove(word)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 4. Loop over the list of words</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> input_text
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> word <span style=color:#f92672>in</span> words:
</span></span><span style=display:flex><span>        <span style=color:#75715e>## 4.1 Replace each occurance of a word in the input text with</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>## it&#39;s index in the words list</span>
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> result<span style=color:#f92672>.</span>replace(word, str(words<span style=color:#f92672>.</span>index(word)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result, words
</span></span></code></pre></div><p>With this approach we get the result:</p><pre tabindex=0><code>Original Length of text = 2720
Length of compressed text = 1921
</code></pre><p>That&rsquo;s ~%30 space savings! While this is great it&rsquo;s far from as efficient as more complex and robust compression systems (gzip can get up to %90). There is a reason we are returning the <code>words</code> list, and it&rsquo;s so we can decompress the text later.</p><p>So now how do we get back our original text? Well we just go through and replace the indicies with the words right? Well&mldr; yes and no. That&rsquo;s the basic idea, but consider the text <code>9 12s 254y</code>, the three numbers are <code>(9,12,254)</code> right? Well if we replace indicies one at a time starting from 0 it would be considered <code>(9,1,2,2,5,4)</code> instead. So what we need to do is start from the <strong>last index</strong> and work our way backwards, so the largest numbers are replaced first:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decompress</span>(compressed_text: str, terms:str) <span style=color:#f92672>-&gt;</span> str:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Decompresses text based on index-replaced compression</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> compressed_text
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># Start from last element</span>
</span></span><span style=display:flex><span>    index <span style=color:#f92672>=</span> len(terms)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> index <span style=color:#f92672>&gt;=</span><span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        <span style=color:#75715e># Replace each element from end to beginning </span>
</span></span><span style=display:flex><span>        result <span style=color:#f92672>=</span> result<span style=color:#f92672>.</span>replace(str(index), terms[index])
</span></span><span style=display:flex><span>        index <span style=color:#f92672>-=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span></code></pre></div><p>We will need to pass it the list used to compress the data so we have the correct indicies to decompress it with. So to use it we can do:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>result, terms <span style=color:#f92672>=</span> compress_with_counter(input_text)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Decompressed text is: </span><span style=color:#e6db74>{</span>decompress(result, terms)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>Which gives us (text cut off to save space):</p><pre tabindex=0><code>Decompressed text is: &#34;
Compression is a fundamental technique used in various fields to reduce the size of data while preserving its essential information. In computer science and information technology, data compression plays a crucial role in storage, transmission, and processing of large amounts of information. By eliminating redundancy and exploiting patterns in data, compression algorithms can significantly reduce file sizes, resulting in more efficient use of storage space and faster data transfer over networks. From simple algorithms like run-length encoding to sophisticated methods like Huffman coding and Lempel-Ziv-Welch (LZW) algorithm, compression enable...&#34;
</code></pre><p>In the real world we would export out the compressed text along with the list of words in some sort of format so we could store it long term and voila.</p><p>There&rsquo;s still a major problem; How can we tell which numbers are part of the compression, and which numbers are part of the text? I&rsquo;ll leave you to try to solve those problems 😉</p><h2 id=images>Images</h2><p>Let&rsquo;s talk about a quick scheme to compress images. First we need to make up a fake encoding for storing image data. When we are looking at images they are broken up into little squares called pixels. Each pixel in our format will have 3 numbers between 0-255 representing the amount of red, green and blue. So for example if we had (255, 0, 0) that would be 100% red, (0, 255, 0) would be 100% Green and (0, 0, 255) would be 100% blue. Then also something like (127, 127, 127) would be a medium grey (0,0,0) would be pure black, and (255,255,255) would be pure white.</p><p><img src=../../img/blog/compression/colours.png alt></p><p>We can then have a list of these tuples of 3 to represent pixels in an image. So for example this 5 pixel by 5 pixel image of the letter T (added white around the black to make the pixel lines clearer):</p><p><img src=../../img/blog/compression/pixel-image.png alt></p><p>We end up with the following representation in code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>image_values <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    [(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>)],
</span></span><span style=display:flex><span>    [(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),      (<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>),(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>),(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>),      (<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>)],
</span></span><span style=display:flex><span>    [(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>)],
</span></span><span style=display:flex><span>    [(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>)],
</span></span><span style=display:flex><span>    [(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>),(<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>)],
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>Here is a visual representation of the mapping:</p><p><img src=../../img/blog/compression/values.png alt></p><h3 id=the-algorithm-1>The algorithm</h3><p>Now we have our format we can start planning an algorithm</p><ol><li>Round each number up to the next multiple of 5 (except 255, which stays 255). So if we had the tuple <code>(120, 253, 119)</code> we would get <code>(125, 255, 120)</code> and if we had <code>(255, 0, 1)</code> we would get <code>(255, 5, 5)</code></li><li>Count the occurence of each tupple</li><li>Replace each tupple with the index of where it would appear in the list of occurences, until you reach 11 digits (10 billion item list) or more (since that&rsquo;s longer than the tuple representation in text)</li></ol><p>The first step will make our algorithm lossy, we can be up to 12 bytes inaccurate in terms of colour from the original.</p><p>So if we have the example of:</p><p><img src=../../img/blog/compression/image-mapping.png alt></p><p>We could compress using:</p><p><img src=../../img/blog/compression/image-mapping-compressed.png alt></p><p>Then when we decode we just look for tuples of length 1 (like <code>(1)</code> instead of length 3 like <code>(255,255,255)</code>)</p><p>The code to do all of this is:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> typing <span style=color:#f92672>import</span> List, Tuple
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> collections <span style=color:#f92672>import</span> Counter
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>round_pixels</span>(image_values: List[List[List[int]]]) <span style=color:#f92672>-&gt;</span> List[List[Tuple[int]]]:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Takes in a representation of image values, rounds the pixels to nearest number divisible </span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># by 5 and then returns the new representation with tuples instead of lists</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> image_values:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> pixel <span style=color:#f92672>in</span> row:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> index, value <span style=color:#f92672>in</span> enumerate(pixel):
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> value <span style=color:#f92672>%</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>: <span style=color:#75715e># Value is divisible by 5</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> len(str(value)) <span style=color:#f92672>==</span><span style=color:#ae81ff>3</span>: <span style=color:#75715e># 3 digit number</span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> int(str(value)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>5</span>:
</span></span><span style=display:flex><span>                            pixel[index] <span style=color:#f92672>=</span> int(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>str(value)[<span style=color:#ae81ff>0</span>]<span style=color:#e6db74>}{</span>int(str(value)[<span style=color:#ae81ff>1</span>])<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74>0&#34;</span>)
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                            pixel[index]<span style=color:#f92672>=</span> int(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>str(value)[<span style=color:#ae81ff>0</span>]<span style=color:#e6db74>}{</span>str(value)[<span style=color:#ae81ff>1</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>5&#34;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>elif</span> len(str(value)) <span style=color:#f92672>==</span><span style=color:#ae81ff>2</span>: <span style=color:#75715e># 2 digit number</span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> int(str(value)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>5</span>:
</span></span><span style=display:flex><span>                            pixel[index] <span style=color:#f92672>=</span> int(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>int(str(value)[<span style=color:#ae81ff>0</span>])<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74>0&#34;</span>)
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                            pixel[index]<span style=color:#f92672>=</span> int(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>str(value)[<span style=color:#ae81ff>0</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>5&#34;</span>)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>elif</span> len(str(value)) <span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>: <span style=color:#75715e># single digit number</span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> value <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>5</span>:
</span></span><span style=display:flex><span>                            pixel[index] <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span> 
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                            pixel[index] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Convert lists to tuples since  lists can&#39;t be used with Counter</span>
</span></span><span style=display:flex><span>    image_values <span style=color:#f92672>=</span> [[tuple(pixel) <span style=color:#66d9ef>for</span> pixel <span style=color:#f92672>in</span> row] <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> image_values]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> image_values
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>compress_image</span>(image_values: List[List[List[int]]]):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 1. &#34;Round&#34; pixel values to nearest multiple of 5</span>
</span></span><span style=display:flex><span>    image_values <span style=color:#f92672>=</span> round_pixels(image_values)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 2. Count tuple occurances</span>
</span></span><span style=display:flex><span>    counter <span style=color:#f92672>=</span> Counter()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> image_values:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> pixel <span style=color:#f92672>in</span> row:
</span></span><span style=display:flex><span>            counter[pixel] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 2.1 Convert to dictionary to make it easier to work with</span>
</span></span><span style=display:flex><span>    terms <span style=color:#f92672>=</span> dict(counter)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 2.2 Make a list of the terms</span>
</span></span><span style=display:flex><span>    common_pixels <span style=color:#f92672>=</span> list(terms<span style=color:#f92672>.</span>keys())
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>## 2.3 Raise an error if the compression would result in larger files</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(common_pixels) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10_000_000_000</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>ValueError</span>(<span style=color:#e6db74>&#34;Image has too many unique values to be compressed&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 3. Replace occurences of tuples with their index in the list of common pixels</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> image_values
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> index, row <span style=color:#f92672>in</span> enumerate(result):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> inner_list_index, pixel <span style=color:#f92672>in</span> enumerate(row):
</span></span><span style=display:flex><span>            result[index][inner_list_index] <span style=color:#f92672>=</span> tuple([common_pixels<span style=color:#f92672>.</span>index(pixel) <span style=color:#66d9ef>if</span> pixel <span style=color:#f92672>in</span> common_pixels <span style=color:#66d9ef>else</span> pixel])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result, common_pixels
</span></span></code></pre></div><p>We can then test it using:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>image_values <span style=color:#f92672>=</span> [ 
</span></span><span style=display:flex><span>    <span style=color:#75715e># Start with third dimension being a list so the values can be rounded (tuples are immutable)</span>
</span></span><span style=display:flex><span>    [[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>]],
</span></span><span style=display:flex><span>    [[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],      [<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>],[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>],[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>],      [<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>]],
</span></span><span style=display:flex><span>    [[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>]],
</span></span><span style=display:flex><span>    [[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>]],
</span></span><span style=display:flex><span>    [[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>],[<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>,<span style=color:#ae81ff>255</span>]],
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Original size of image = </span><span style=color:#e6db74>{</span>len(str(image_values))<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>result, common_pixels <span style=color:#f92672>=</span> compress_image(image_values)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Compressed size of image = </span><span style=color:#e6db74>{</span>len(str(result))<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>Which in our case gives us:</p><pre tabindex=0><code>Original Length of text = 399
Length of compressed text = 160
</code></pre><p>Which is not bad, it&rsquo;s about ~%60 efficient.</p><p>and then to decompress would be:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decompress_image</span>(image_values:List[List[Tuple[int]]], common_pixels:List[Tuple[int]]):
</span></span><span style=display:flex><span>    <span style=color:#75715e># Takes in a compressed image, and the mapping used to compress it, and decompresses back to original form</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> image_values
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> index, row <span style=color:#f92672>in</span> enumerate(result):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j_index, pixel <span style=color:#f92672>in</span> enumerate(row):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> len(pixel) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>: <span style=color:#75715e># Was compressed, convert back to original value</span>
</span></span><span style=display:flex><span>                result[index][j_index] <span style=color:#f92672>=</span> tuple([common_pixels[pixel[<span style=color:#ae81ff>0</span>]]])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span></code></pre></div><p>This works well, but it cannot run for images above a few hundred pixels by a few hundred pizels because it is very inefficient. You can test this yourself by generating some test data using the following function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>create_test_data</span>(width:int, height:int) <span style=color:#f92672>-&gt;</span> List[List[List[int]]]:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Generates test data to be used with compress_image()</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> range(width):
</span></span><span style=display:flex><span>        current_row <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> column <span style=color:#f92672>in</span> range(height):
</span></span><span style=display:flex><span>            current_row<span style=color:#f92672>.</span>append([random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>255</span>), random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>255</span>), random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>255</span>)])
</span></span><span style=display:flex><span>        result<span style=color:#f92672>.</span>append(current_row)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result
</span></span></code></pre></div><p>Testing with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>image_values <span style=color:#f92672>=</span> create_test_data(<span style=color:#ae81ff>200</span>,<span style=color:#ae81ff>200</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Original Length of text = </span><span style=color:#e6db74>{</span>len(str(image_values))<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>result, common_pixels <span style=color:#f92672>=</span> compress_image(image_values)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Length of compressed text = </span><span style=color:#e6db74>{</span>len(str(result))<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Compression ratio is ~%</span><span style=color:#e6db74>{</span>((len(str(result))<span style=color:#f92672>/</span>len(str(image_values))))<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>Which gives us:</p><pre tabindex=0><code>Original Length of text = 628658
Length of compressed text = 386393
Compression ratio is ~%60.9185562166747
</code></pre><p>It took a min or two on my machine, but at 500,500 it still wasn&rsquo;t done after 5 mins. The scaling is very poor because it has to check every value of every pixel, so for 200x200 that&rsquo;s 40,000 checks, and for 500x500 that&rsquo;s 250,000 checks and for each pixel we need to round the values 😵‍💫. Try to figure out a more efficient way of doing this if you can!</p><h2 id=file-types>File types</h2><p>There are generally 2 types of files:</p><ul><li>Text files</li><li>Binary files</li></ul><p>Text files are just plain text that have some sort of encoding. They are meant to be readable and are used for things like source code, plain text files, markup files etc.</p><p>Binary files are files that either:</p><ol><li>Are meant to be run with a specific program (i.e. PDF&rsquo;s need a PDF reader, images need a photo viewer etc.)</li><li>Are meant to be executed (i.e. an application)</li></ol><p>For images you will mostly be working with binary files, these are a bit different than text files. With text files it makes sense for us to simply read each word or letter, with binary files the organization of data changes by file type. For one file like a binary format spreadsheet maybe you want all the data until a <code>;</code> or <code>,</code> in the file, whereas for images you may want tuples of 3 numbers <code>(255,255,255)</code> which correspond to RGB values.</p><p>Each binary file differs in how you want to read it, so be careful when working with them. For most image-related activities check out <a href=https://pypi.org/project/Pillow/>pillow</a> for python!</p><h2 id=video>Video</h2><p>This article is already long enough so we are going to skip video because it&rsquo;s quite a bit more complicated. See the section below for common real-world examples, and take a look at our section about <a href=../../definitions/compression#sampling>sampling</a> in the compression defition.</p><h2 id=real-world-compression-systems>Real world compression systems</h2><p>Most real world compression systems are based on the encoding they use. But here are a few examples you can look at:</p><p><strong>Text</strong></p><p>Algorithms that make up common compression systems</p><ul><li>Huffman Coding (this solves the problem of numbers in our algorithm)<ul><li><a href="https://www.youtube.com/watch?v=JsTptu56GM8">How Computers Compress Text: Huffman Coding and Huffman Trees</a></li><li><a href="https://www.youtube.com/watch?v=iEm1NRyEe5c">Huffman coding step-by-step example</a></li><li><a href="https://www.youtube.com/watch?v=umTbivyJoiI">How Huffman Trees Work - Computerfile</a></li><li><a href=https://cmps-people.ok.ubc.ca/ylucet/DS/Huffman.html>Huffman Coding Visualizer</a></li></ul></li><li>LZ77/LZ1<ul><li><a href="https://www.youtube.com/watch?v=goOa3DGezUA">Elegant Compression in Text (The LZ 77 Method) - Computerphile</a></li><li><a href="https://www.youtube.com/watch?v=RV5aUr8sZD0">The Beauty of Lempel-Ziv Compression</a></li><li><a href="https://www.youtube.com/watch?v=jVcTrBjI-eE">Learn in 5 Minutes: LZ77 Compression Algorithms</a></li><li><a href="https://www.youtube.com/watch?v=zev2A2uWYsM">17. LZ77 Encoding, decoding with examples.</a></li><li><a href=https://kg86.github.io/visstr/dist/vis_str_demo.html>String Visualizer</a></li></ul></li><li>Deflate<ul><li><a href="https://www.youtube.com/watch?v=O1NATKw6G_U">An explanation of the Deflate Algorithm</a></li><li><a href=https://www.zlib.net/feldspar.html>An Explanation of the Deflate Algorithm (original publication)</a></li><li><a href="https://www.youtube.com/watch?v=oi2lMBBjQ8s">Data Compression (Summer 2020) - Lecture 11 - DEFLATE (gzip)</a></li></ul></li></ul><p>Common compression systems (Use deflate, huffman coding, and LZ77/LZ1)</p><ul><li>Gzip; A generic compression system used in most browsers and applications<ul><li><a href="https://www.youtube.com/watch?v=NLtt4S9ErIA">Gzip file compression in 100 seconds</a></li><li><a href="https://www.youtube.com/watch?v=maL-SqyXvj8">How Gzip Compression Works</a></li><li><a href="https://www.youtube.com/watch?v=wLx5OGxOYUc">Raul Fraile: How GZIP compression works | JSConf EU 2014</a></li></ul></li><li>Brotli; A webpage optimized compression system<ul><li><a href="https://www.youtube.com/watch?v=Uiyu3uo4OAE">Brotli Compression vs GZIP Compression</a></li><li><a href=https://www.brotli.org/>Brotli site</a></li><li><a href=https://github.com/google/brotli>Source code</a></li></ul></li></ul><p><strong>Image</strong></p><ul><li>JPG; Very common <a href=#lossy>lossy</a> image compression<ul><li><a href="https://www.youtube.com/watch?v=Kv1Hiv3ox8I">This video</a></li><li>These two videos from computephile<ul><li><a href="https://www.youtube.com/watch?v=n_uNPbdenRs">Part 1</a></li><li><a href="https://www.youtube.com/watch?v=Q2aEzeMDHMA">Part 2</a></li></ul></li><li><a href=https://en.wikibooks.org/wiki/JPEG_-_Idea_and_Practice>This set of articles</a></li></ul></li><li>PNG; Common <a href=#lossless>lossless</a> image format that also supports transparency<ul><li><a href=https://medium.com/@duhroach/how-png-works-f1174e3cc7b7>How PNG Works</a></li><li><a href="https://www.youtube.com/watch?v=EFUYNoFRHQI">How PNG Works: Compromising Speed for Quality</a></li><li><a href=https://compress-or-die.com/Understanding-PNG>Finally understanding PNG</a></li></ul></li><li>Base64; A text-based way of storing image data<ul><li><a href="https://www.youtube.com/watch?v=7gSSMy_M4HU">Base64 Encoding/Decoding explained</a></li><li><a href="https://www.youtube.com/watch?v=EPlXPdNvQEY">How to Convert Images Into Base 64 Data URLs with JavaScript</a></li><li><a href="https://www.youtube.com/watch?v=fe062UdOKuo">Reduce base64 image file size | JavaScript</a></li></ul></li></ul><p>A good broad topic video can be found <a href="https://www.youtube.com/watch?v=Ba89cI9eIg8">here</a></p><p><strong>Video</strong></p><ul><li>MPEG; Set of formats used for videos (mpeg-4 is also known at <code>.mp4</code> files)<ul><li><a href="https://www.youtube.com/watch?v=F0ZinF-gTrY">What is MPEG Format | What is MPEG 4 Format | What are MPEG 1, MPEG 2 & MPEG 21</a></li><li><a href="https://www.youtube.com/watch?v=Ky4CaKw7tdo">MPEG Algorithm - Video & Audio Compression - Data Compression & Encryption</a></li></ul></li><li>h.264; THe encoding used for most videos on the web today<ul><li><a href="https://www.youtube.com/watch?v=J9RemuYxA4s">H.264 Part 1: Encoding & Decoding Basics</a></li><li><a href="https://www.youtube.com/watch?v=1PMqXdWJHNs">H 264 Video Compression</a></li><li><a href=https://www.vcodex.com/an-overview-of-h264-advanced-video-coding/>An Overview of H.264 Advanced Video Coding</a></li><li><a href=https://api.video/what-is/h-264/>api.video h.264</a></li><li><a href=https://www.e-consystems.com/blog/camera/technology/what-is-h-264-video-encoding-how-does-h-264-codec-work/>What is H.264 video encoding? How does H.264 codec work?</a></li></ul></li></ul><p>Most commonly videos are MPEG-4 (<code>.mp4</code>) using a <code>h.264</code> codec to encode the data. A good broad topic video can be found <a href="https://www.youtube.com/watch?v=QoZ8pccsYo4">here</a></p></div><div class="card text-center"><div class=share-icons><h2>Share the article</h2><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fschulichignite.com%2fblog%2fmaking-things-small%2f" target=_blank><i class="bi bi-facebook"></i></a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fschulichignite.com%2fblog%2fmaking-things-small%2f" target=_blank><i class="bi bi-linkedin"></i></a>
<a href="https://twitter.com/intent/tweet?text=Check%20out%20this%20post%20from%20schulich%20ignite%3A%0Ahttps%3a%2f%2fschulichignite.com%2fblog%2fmaking-things-small%2f" target=_blank><i class="bi bi-twitter"></i></a></div><a href=../../blog/index.xml target=_blank class=p-3>or subscribe to the blog with RSS <i class="bi bi-rss-fill"></i></a></div></div></div></div></div></section></body><footer class="footer sticky-bottom" style=position:fixed;background-color:#ffcdae><div class=container><div class=row><a href=https://www.instagram.com/schulichignite target=_blank rel="noopener noreferrer"><i class="bi bi-instagram is-large"></i></a>
<a href=https://www.youtube.com/channel/UC7tNvdbu952HOUl_4nK7iww target=_blank rel="noopener noreferrer"><i class="bi bi-youtube is-large"></i></a>
<a href=https://vm.tiktok.com/ZSHPbWU3/ target=_blank rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentcolor" class="bi bi-tiktok is-large mt-3" viewBox="0 0 16 16"><path d="M9 0h1.98c.144.715.54 1.617 1.235 2.512C12.895 3.389 13.797 4 15 4v2c-1.753.0-3.07-.814-4-1.829V11A5 5 0 116 6v2a3 3 0 103 3V0z"/></svg></a><a href=https://www.facebook.com/SchulichIgnite/ target=_blank rel="noopener noreferrer"><i class="bi bi-facebook is-large"></i></a>
<a href=https://linkedin.com/company/schulich-ignite/ target=_blank rel="noopener noreferrer"><i class="bi bi-linkedin is-large"></i></a>
<a href=https://discord.gg/F3Qjqqj target=_blank rel="noopener noreferrer"><i class="bi bi-discord is-large"></i></a></div></div></footer><script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js integrity=sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js integrity=sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js integrity="sha512-bgHRAiTjGrzHzLyKOnpFvaEpGzJet3z4tZnXGjpsCcqOnAH6VGUx9frc5bcIhKTVLEiCO6vEhNAgx5jtLUYrfA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/django.min.js integrity="sha512-1NHUMVlHsFnOe0Q36JMbBrNrjVcMdue2occC2xHWYXo7epa3YR54ZibI1G4I+tnJKBGNib11d8JzOElMfUSpYg==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/http.min.js integrity="sha512-4Rcwpn+xUuCDufCycA9UtpmboCxNHysWy23e45PJBQeh7m6Kno5/oQ4T5SmbmSAAZiDsm/IsX1IJwsOjy6ob0g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/http.min.js integrity="sha512-4Rcwpn+xUuCDufCycA9UtpmboCxNHysWy23e45PJBQeh7m6Kno5/oQ4T5SmbmSAAZiDsm/IsX1IJwsOjy6ob0g==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>hljs.addPlugin(new CopyButtonPlugin),hljs.highlightAll(),hljs.initLineNumbersOnLoad()</script><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@9/dist/mermaid.esm.min.mjs';
    
    let mermaidConfig = {
    startOnLoad: true,
    "theme": "base",
        "themeVariables": {
            "primaryColor": "#ffde59",
            "primaryTextColor": "#d14b3b",
            "primaryBorderColor": "#7C0000",
            "lineColor": "#F8B229",
            "secondaryColor": "#fff",
            "tertiaryColor": "#d14b3b"
        }
    }
    mermaid.initialize(mermaidConfig, '.language-mermaid');
</script><script>window.onload=()=>{words={},articleContent=document.getElementById("article-content").innerHTML,contentSections=articleContent.match(/<p>(.*?)<\/p>|<ul>(.*?)<\/ul>|<ol>(.*?)<\/ol>/g),contentSections.forEach(e=>{for(word in words)searchMask=` ${word} |^${word} |${word}$| ${word}$|${word},`,regEx=new RegExp(searchMask,"igm"),newval=`${e}`.replace(regEx,` <a href="${words[word][0]}" target="_blank" data-toggle="tooltip" data-placement="top" title="${words[word][1]}">${word}</a> `),document.getElementById("article-content").innerHTML=document.getElementById("article-content").innerHTML.replace(e,newval)}),$(function(){$('[data-toggle="tooltip"]').tooltip()})}</script></html>